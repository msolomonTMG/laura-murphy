$Crabapple.TriforceModule_ent_m171={parentController:'$Crabapple.TriforceModule',extension:{viewName:'$Crabapple.TriforceView_ent_m171',body:$('body'),pageContents:$('body'),searchFeedURL:null,searchFeedParams:'&wt=json&fl=seasonNumber_s,episodeNumber_s,url_s,%20imageUrl_s,imageHeight_i,imageWidth_i,imageRatio_f,duration_s,parentTitle_t,title_t,contentType_s,episodeTitle_t,bucketName_s,labelName_s,contentDate_dt,isTveAuthRequiredForDesktop_b,isTveAuthRequiredForMobile_b&defType=edismax',facetedResultsParams:'&facet=on&facet.field=bucketName_s&facet.mincount=1',maxCount:80,pageNumber:0,rowsPerPage:16,currentItemNum:0,itemsRenderedCount:0,totalResults:null,searchStartTime:null,filterTerm:null,callbackPrefix:'searchModuleCallback',arrCallbackSuffix:[{'idx':1,'available':true}],ajaxRequestTimer:0,ajaxRequestDelay:200,requestNumber:0,trendingSelection:'.s_trending_snapHeader',moduleName:'ent_m171',isMobile:false,alphanumericAndSymbols:/[^a-zA-Z0-9!@#\$%\^\&*\)\(\s+=._-]+$/g,tabsFilter:false,searchSeries:false,searchSeriesFeedParams:null,feed:null,settings:null,seasonLabel:'',episodeLabel:'',postRender:function(){var _this=this;_this.setModuleData();_this.initMobileConfig();_this.addLinkHandler();_this.initShowOverlayButton();_this.initScrollSetFocus();_this.initScrollTriggerBroker();_this.initKeyEvent();_this.initKeyControls();},setModuleData:function(){var _this=this;_this.feed=_this.feedResponse.result.data;_this.settings=_this.feedResponse.result.settings;_this.seasonLabel=_this.settings.seasonLabel;_this.episodeLabel=_this.settings.episodeLabel;if(_this.feed&&_this.feed.showId&&_this.feed.seriesTrendingResults&&_this.feed.seriesTrendingResults.length){_this.searchSeriesFeedParams=_this.searchFeedParams+'&fq=parentId_s_mv:'+_this.feed.showId;_this.searchSeries=true;}
_this.view.setData(_this.feed);_this.view.setViewElements();_this.view.setBreakpoint();if(typeof(config.getSearchFeedURL)==='function'){_this.searchFeedURL=config.getSearchFeedURL();}},initMobileConfig:function(){var _this=this;_this.isMobile=window.Triforce.getMediator().isMobile();if(_this.isMobile){_this.view.initMobileSearch();}},addEvents:function(){var _this=this;$('.s_layouts_this_show',_this.moduleElement).on('click',function(event){_this.refineResults(event,true);});$('.s_layouts_whole_site',_this.moduleElement).on('click',function(event){_this.refineResults(event);});},trimToFit:function(){$('.s_layouts_snapResultsWrapper .s_layouts_snapItemDetails .s_layouts_snapItemTitle').trimTextToFit();},setImageRatio:function(){var _this=this;_this.moduleElement.find('div.image_holder').each(function(){var parent_anchor=$(this).closest('a');if($(this).data("ratio")===0.7){parent_anchor.addClass("s_layouts_snapItemSeriesPoster");}});},refineResults:function(event,isShow){event.preventDefault();var _this=this,newClass='.s_layouts_whole_site',oldClass='.s_layouts_this_show',trackingText='Whole Site';if(isShow){newClass='.s_layouts_this_show';oldClass='.s_layouts_whole_site';trackingText='This Show';if(_this.feed.showId){_this.searchSeriesFeedParams=_this.searchFeedParams+'&fq=parentId_s_mv:'+_this.feed.showId;_this.searchSeries=true;}}else{_this.searchSeries=false;}
_this.fadeOutResults();_this.resultsClearOut();_this.playLoadingAnim('loadingFirstPage');if(_this.view.snapInput.val().trim().length&&(_this.view.snapInput.val()!==_this.view.data.placeHolderText)){_this.delayProcessSearch(false);}else{clearTimeout(_this.ajaxRequestTimer);_this.ajaxRequestTimer=setTimeout(function(){_this.initTrendingView();},_this.ajaxRequestDelay);}
_this.moduleElement.find(newClass).addClass('highlight');if(_this.moduleElement.find(oldClass).has('highlight')){_this.moduleElement.find(oldClass).removeClass('highlight');}
_this.moduleActionTracking(_this,'click on '+trackingText,'');},logger:function(msg){},fireTrackingOverlayOpen:function(_this){_this.logger('fireTrackingOverlayOpen called');_this.searchStartTime=new Date();_this.moduleActionTracking(_this,'open overlay','event8',{'v.searchOverlay':'true'});},fireTrackingOverlayClose:function(_this){_this.logger('fireTrackingOverlayClose called');var contextVars={'v.searchAbandon':'true'}
var events='event9';if(!!_this.moduleElement.find('.s_layouts_snapInput').val()){events+=',event36';contextVars['v.searchEvent']='true';if(!_this.totalResults){events+=',event37';contextVars['v.searchFail']='true';}}
if(_this.totalResults){events+=',event38';contextVars['v.searchResult']='true';}
_this.moduleActionTracking(_this,'search close button',events,contextVars);},fireTrackingTabs:function(_this,tabName){_this.logger('fireTrackingTabs called');if(typeof(tabName)==='undefined'||null===tabName){return;}
$Crabapple.repo.trackModuleClickThrough(_this.moduleName,'tab_'+tabName.toLowerCase(),'click on '+tabName.toLowerCase());},getHeaderModuleName:function(){var moduleName='unknown header';if(typeof triforceManifestFeed!=='undefined'&&triforceManifestFeed&&triforceManifestFeed.zones&&triforceManifestFeed.zones.header){moduleName=triforceManifestFeed.zones.header.moduleName.split('_').splice(0,2).join('_').toLowerCase();}
return moduleName;},moduleClickTracking:function(_this,elem){_this.logger('moduleClickTracking called');var repoValues=_this.getSearchTrackingValues(_this),contentType=$(elem).attr('data-content-type'),itemIndex=$(elem).find('.testing_order').text(),destinationURL=$(elem).attr('href'),isTrendingItem=_this.moduleElement.find(_this.trendingSelection).length>0,tagName=_this.moduleElement.find('.s_layouts_snapTab.active').attr('data-filter'),selectionSearch='',actionName='',itemIndexNum=null,events=[];if(_this.moduleElement.find('.s_layouts_this_show.highlight').length>0){selectionSearch=' through This Show';}else if(_this.moduleElement.find('.s_layouts_whole_site.highlight').length>0){selectionSearch=' through Whole Site';}
actionName=(isTrendingItem?'trending item click'+selectionSearch:'search item click'+selectionSearch);if(itemIndex){itemIndexNum=(new Number(itemIndex))+1;repoValues.data.prop39=''+itemIndexNum;repoValues.contextVariables["v.searchItemIndex"]=''+itemIndexNum;}
if(repoValues.data.eVar2){events.push('event36');repoValues.contextVariables["v.searchEvent"]='true';if(isTrendingItem){events.push('event35');repoValues.contextVariables["v.searchConversion"]='true';if(!!_this.moduleElement.find('.s_layouts_snapInput').val()){events.push('event37');repoValues.contextVariables["v.searchFail"]='true';}}else{events.push('event35');repoValues.contextVariables["v.searchConversion"]='true';events.push('event38');repoValues.contextVariables["v.searchResult"]='true';}
repoValues.data.events=events.join();if(!tagName){tagName='none';}
if(isTrendingItem){repoValues.data.eVar3='trending item';repoValues.contextVariables["v.searchType"]='trending item';repoValues.data.eVar16='Trending Item Click';repoValues.contextVariables["v.actName"]='Trending Item Click';}else{repoValues.data.eVar3=tagName;repoValues.contextVariables["v.searchType"]=tagName;if(typeof contentType!=='undefined'&&contentType){repoValues.data.eVar3+='|'+contentType;repoValues.contextVariables["v.searchType"]+='|'+contentType;}else{repoValues.data.eVar3+='|none';repoValues.contextVariables["v.searchType"]+='|none';}}}
if(typeof destinationURL!=='undefined'&&destinationURL){if(destinationURL.substr(0,1)==='/'){destinationURL=window.location.protocol+'//'+window.location.host+destinationURL;}
repoValues.data.eVar5=destinationURL;repoValues.data.prop27=destinationURL;repoValues.contextVariables["v.destURL"]=destinationURL;}
repoValues.data.linkName=_this.getHeaderModuleName();repoValues.contextVariables.linkName=_this.getHeaderModuleName();repoValues.contextVariables['v.activity']='search';$Crabapple.repo.trackModuleClickThrough(_this.moduleName,$(elem).attr('href'),actionName,repoValues.data,repoValues.contextVariables);},moduleActionTracking:function(_this,actionName,eventName,contextVariables){_this.logger('moduleActionTracking['+actionName+'] called');var repoValues=_this.getSearchTrackingValues(_this);if(actionName==='open overlay'){repoValues.data.eVar2=null;repoValues.contextVariables["v.searchTerm"]=null;}
if(typeof actionName!=='undefined'){repoValues.data.eVar16=actionName;repoValues.contextVariables["v.actName"]=actionName;}
if(typeof eventName!=='undefined'){repoValues.data.events=eventName;}
if(typeof contextVariables!=='undefined'){repoValues.contextVariables=Object.assign(contextVariables,repoValues.contextVariables);}
repoValues.data.linkName=_this.getHeaderModuleName();repoValues.contextVariables['v.activity']='search';$Crabapple.repo.trackModuleAction(_this.moduleName,actionName,repoValues.data,repoValues.contextVariables);},getSearchTrackingValues:function(_this){var searchTerm=_this.moduleElement.find('.s_layouts_snapInput').val(),totalTimeSpent=null,totalSearchResults=_this.totalResults,repoValues={data:{},contextVariables:{}};if(_this.searchStartTime){totalTimeSpent=Math.floor(((new Date()).getTime()-_this.searchStartTime.getTime())/ 1000);}
if(searchTerm){repoValues.data.eVar2=searchTerm;repoValues.contextVariables["v.searchTerm"]=searchTerm}else{repoValues.data.eVar2='no search term';repoValues.contextVariables["v.searchTerm"]='no search term';}
if(totalSearchResults){repoValues.data.prop23=''+totalSearchResults;repoValues.contextVariables["v.searchResultsFound"]=''+totalSearchResults;}
if(totalTimeSpent){repoValues.data.prop32=''+totalTimeSpent;repoValues.contextVariables["v.searchTimeSpent"]=''+totalTimeSpent;}
return repoValues;},pauseVideoPlayers:function(pause){var _players=[],cssSearchPaused='search-paused';if(window.EdgePlayer){_players=window.EdgePlayer.getPlayers();}
if(_players.length>0){for(var i=0;i<_players.length;i++){if(pause){_players[i].pause();_players[i].$el.addClass(cssSearchPaused);}else if(_players[i].$el.hasClass(cssSearchPaused)){_players[i].$el.removeClass(cssSearchPaused);}}}},closeOverlay:function(){var _this=this;if(_this.view.snapWrapper.hasClass('open')){_this.fireTrackingOverlayClose(_this);_this.view.snapWrapper.removeClass('open').addClass('fadeOut');_this.pageContents.removeClass('search-open');_this.fadeOutResults();_this.resultsClearOut();_this.body.removeClass('noscroll');_this.view.snapWrapper.on('transitionend webkitTransitionEnd oTransitionEnd',function(event){_this.view.snapWrapper.removeClass('fadeOut');_this.view.snapInput.val('');_this.resetInputPlaceholder();$(this).off(event);});}else{_this.view.snapWrapper.removeClass('fadeOut');}},initShowOverlayButton:function(){var _this=this;if(_this.moduleElement.find('.series_specific').length>0){if((this.feed&&!this.feed.seriesTrendingResults)||(this.feed&&this.feed.seriesTrendingResults.length===0)){_this.view.snapSearch.css('display','none');}}
_this.body.off('click.snap_open').on('click.snap_open','.site_header .search_wrapper, .js_header .search_wrapper, .js-trigger-search',function(event){_this.fireTrackingOverlayOpen(_this);_this.view.snapWrapper.addClass('open');_this.body.addClass('noscroll');_this.pageContents.addClass('search-open');if(_this.feed.showId&&(_this.feed&&_this.feed.seriesTrendingResults)&&(_this.feed&&_this.feed.seriesTrendingResults.length>0)){$('.s_layouts_whole_site').removeClass('highlight');$('.s_layouts_this_show').addClass('highlight');_this.searchSeriesFeedParams=_this.searchFeedParams+'&fq=parentId_s_mv:'+_this.feed.showId;_this.searchSeries=true;}
_this.resultsClearOut();_this.initTrendingView();_this.pauseVideoPlayers(true);event.preventDefault();_this.view.snapInput.focus();});this.moduleElement.find('.s_layouts_snapClose').off('click.snap_close').on('click.snap_close',function(event){_this.pauseVideoPlayers(false);_this.closeOverlay();});},initScrollSetFocus:function(){var _this=this;this.view.snapWrapper.off('scroll.snap_scroll').on('scroll.snap_scroll',function(){_this.view.snapWrapper.attr("tabindex",-1).focus();});},initScrollTriggerBroker:function(){var _this=this;this.view.snapWrapper.off('scroll.snap_scrollbroker').on('scroll.snap_scrollbroker',function(){_this.triggerImageBroker();});},initTrendingView:function(message){var _this=this;_this.view.snapWrapper.off('scroll.snap_loadMore');_this.moduleElement.find('.s_layouts_snapItemLink').off('click.searchClickThrough');_this.view.emptyTabs();_this.view.renderHeader(_this.feed);_this.view.removeMessage();if(message){_this.view.generateMessage(_this.feed.failedResultText);}
if(!_this.searchSeries){if(_this.feed&&this.feed.trendingResults&&_this.feed.trendingResults.length>0){_this.sortSearchResults(_this.feed.trendingResults);}else{}}else{if(_this.feed&&_this.feed.seriesTrendingResults&&_this.feed.seriesTrendingResults.length>0){_this.sortSearchResults(_this.feed.seriesTrendingResults);}else{}}
this.moduleElement.find('.s_layouts_snapItemLink').on('click.searchClickThrough',function(evt){_this.moduleClickTracking(_this,this);});},resetInputPlaceholder:function(){var _this=this;_this.view.snapInput.attr('placeholder',_this.view.data.placeHolderText);},initKeyControls:function(){var _this=this;$(document).on('keyup',function(e){if(e.which===27){_this.closeOverlay();}});},initKeyEvent:function(){var _this=this,keyStroke;this.view.snapInput.on('keyup',function(e){keyStroke=String.fromCharCode(e.which);if(this.isMobile){if(e.which===13){_this.preventReturnBtnClick(e);}}
if(e.which===37||e.which===38||e.which===39||e.which===40){return false;}
if((!_this.alphanumericAndSymbols.test(keyStroke))||e.which===8){_this.requestNumber++;_this.fadeOutResults();_this.resultsClearOut();_this.playLoadingAnim('loadingFirstPage');if(_this.view.snapInput.val().trim().length){_this.delayProcessSearch(false);}else{clearTimeout(_this.ajaxRequestTimer);_this.ajaxRequestTimer=setTimeout(function(){_this.initTrendingView();},_this.ajaxRequestDelay);}
$(this).off(event);}});this.view.snapInput.on('keypress keydown',function(e){if(this.isMobile){if(e.which===13){_this.preventReturnBtnClick(e);}}
$(this).off(event);});},preventReturnBtnClick:function(event){event.preventDefault();this.moduleElement.find('.s_layouts_snapInput').blur();},delayProcessSearch:function(filteredSearch){var _this=this;_this.snapSearchTerm=_this.view.snapInput.val().trim();clearTimeout(_this.ajaxRequestTimer);_this.ajaxRequestTimer=setTimeout(function(){_this.resultsClearOut(filteredSearch);_this.initScrollLoadMore();_this.createSolrUrl();},_this.ajaxRequestDelay);},initScrollLoadMore:function(){var _this=this,timeoutId=null;this.view.snapWrapper.off('scroll.snap_loadMore').on('scroll.snap_loadMore',function(){if((_this.itemsRenderedCount!==_this.maxCount)&&(_this.itemsRenderedCount<_this.totalResults)&&(!_this.moduleElement.hasClass('loadingFirstPage'))&&_this.checkScrolledPosition()){if(timeoutId!==null){clearTimeout(timeoutId);}
timeoutId=setTimeout(function(){timeoutId=null;_this.onScrollSearch();},20);}});},playLoadingAnim:function(className){if(this.moduleElement.hasClass(className)){this.moduleElement.removeClass(className);}
this.moduleElement.addClass(className);},onScrollSearch:function(){this.getNextResults();this.playLoadingAnim('loadingNextPage');},getNextResults:function(){++this.pageNumber;this.requestNumber++;this.createSolrUrl();},parseQuery:function(query){var seasonEpisodeRegexp=/((season|episode)[\s]?(\d+))/ig,finalTerm=query,seasonNumber,episodeNumber,matches;while(matches=seasonEpisodeRegexp.exec(query)){finalTerm=finalTerm.replace(matches[1],'');switch(matches[2]){case'season':seasonNumber=matches[3];break;case'episode':episodeNumber=matches[3];break;}}
return{term:finalTerm.trim(),seasonNumber:seasonNumber,episodeNumber:episodeNumber};},createSolrUrl:function(){var _this=this,rows=_this.rowsPerPage,start=_this.pageNumber*rows,filter='',solrUrl,additionalParams,searchTerm;if(typeof _this.filterTerm==='string'){if(_this.filterTerm!=='All'){filter='&fq=bucketName_s:'+_this.filterTerm;}}
additionalParams=(filter!=='')?filter:_this.facetedResultsParams;searchTerm=(!_this.alphanumericAndSymbols.test(_this.snapSearchTerm))?_this.snapSearchTerm:_this.snapSearchTerm.replace(_this.alphanumericAndSymbols,'');var searchParseValues=_this.parseQuery(searchTerm);if(_this.searchSeries===true){solrUrl=_this.searchFeedURL+encodeURIComponent(searchParseValues.term)+_this.searchSeriesFeedParams+'&rows='+rows+'&start='+start+additionalParams;if(searchParseValues.seasonNumber&&searchParseValues.episodeNumber){solrUrl=solrUrl+'&fq=seasonNumber_s:'+searchParseValues.seasonNumber+'&fq=episodeNumber_s:'+searchParseValues.episodeNumber;}else if(searchParseValues.seasonNumber){solrUrl=solrUrl+'&fq=seasonNumber_s:'+searchParseValues.seasonNumber;}else if(searchParseValues.episodeNumber){solrUrl=solrUrl+'&fq=episodeNumber_s:'+searchParseValues.episodeNumber;}}else if(!_this.searchSeries){solrUrl=_this.searchFeedURL+encodeURIComponent(searchParseValues.term)+_this.searchFeedParams+'&rows='+rows+'&start='+start+additionalParams;if(searchParseValues.seasonNumber&&searchParseValues.episodeNumber){solrUrl=solrUrl+'&fq=seasonNumber_s:'+searchParseValues.seasonNumber+'&fq=episodeNumber_s:'+searchParseValues.episodeNumber;}else if(searchParseValues.seasonNumber){solrUrl=solrUrl+'&fq=seasonNumber_s:'+searchParseValues.seasonNumber;}else if(searchParseValues.episodeNumber){solrUrl=solrUrl+'&fq=episodeNumber_s:'+searchParseValues.episodeNumber;}}
this.processSearch(solrUrl);},getAvailCallbackName:function(){var suffix=0,lastIdx=0,arrCallbackSuffix=this.arrCallbackSuffix;for(var i=0;i<arrCallbackSuffix.length;i++){if(arrCallbackSuffix[i].available===true){arrCallbackSuffix[i].available=false;suffix=arrCallbackSuffix[i].idx;}
lastIdx=arrCallbackSuffix[i].idx;}
if(suffix===0){suffix=++lastIdx;arrCallbackSuffix.push({'idx':suffix,'available':false});}
return this.callbackPrefix+suffix;},resetCallbackName:function(callbackName){var callbackSuffix=0,arrCallbackSuffix=this.arrCallbackSuffix,callbackPrefix=this.callbackPrefix;callbackSuffix=parseInt(callbackName.substring(callbackPrefix.length,callbackName.length));for(var i=0;i<arrCallbackSuffix.length;i++){if(arrCallbackSuffix[i].idx===callbackSuffix){arrCallbackSuffix[i].available=true;}}},processSearch:function(url){var _this=this;var callbackName=_this.getAvailCallbackName(),requestNumber=_this.requestNumber;$.ajax({"jsonp":"json.wrf","jsonpCallback":callbackName,"dataType":"jsonp","url":url,callbackName:callbackName,requestNumber:requestNumber}).done(function(data,textStatus,jqXHR){_this.resetCallbackName(this.callbackName);if(_this.requestNumber!==this.requestNumber){return false;}
_this.getResultFromSolr(data);}).fail(function(jqXHR,textStatus,errorThrown){_this.fadeOutResults();_this.resultsClearOut();_this.resetCallbackName(this.callbackName);});},getResultFromSolr:function(results){var _this=this;if(results.response&&results.response.docs&&results.response.docs.length>0){_this.sortSearchResults(results.response.docs);_this.totalResults=results.response.numFound;if(results.facet_counts&&results.facet_counts.facet_fields&&results.facet_counts.facet_fields.bucketName_s&&results.facet_counts.facet_fields.bucketName_s.length>-1&&!this.tabsFilter){_this.generateTabInfo(results.facet_counts.facet_fields);}}else{_this.moduleElement.removeClass('loadingFirstPage loadingNextPage');if(_this.itemsRenderedCount===0){_this.fadeOutResults();_this.resultsClearOut();_this.initTrendingView(true);}}
_this.moduleElement.find('.s_layouts_snapItemLink').off('click.searchClickThrough');_this.moduleElement.find('.s_layouts_snapItemLink').on('click.searchClickThrough',function(evt){_this.moduleClickTracking(_this,this);});},sortSearchResults:function(data){var _this=this,currentNum=_this.currentItemNum;var items={columnOne:{docs:[]},columnTwo:{docs:[]},columnThree:{docs:[]},columnFour:{docs:[]}};this.moduleElement.removeClass('loadingFirstPage').removeClass('loadingNextPage');if(data&&data.length){for(var i=0,len=data.length;i<len;i++){currentNum=currentNum+1;var item=data[i];item.renderCount=_this.itemsRenderedCount;if(!item.image){item.image={"width":item.imageWidth_i,"height":item.imageHeight_i,"url":item.imageUrl_s};}
if(item.seasonNumber_s){item.seasonLabel=_this.seasonLabel;if(item.episodeNumber_s){item.episodeLabel=_this.episodeLabel;}}
if(item.bucketName_s==='Articles'){if(item.contentDate_dt){var date,contentDate;date=new Date(item.contentDate_dt);contentDate=(date.getMonth()+1)+'/'+date.getDate()+'/'+date.getFullYear();item.subTitle=contentDate;}}else if(item.parentTitle_t){item.subTitle=item.parentTitle_t;}
if(_this.view.breakpoint.className===_this.view.breakPointTwo.className){if((currentNum)%2===0){if((currentNum)%4===0){items.columnFour.docs.push(data[i]);}else{items.columnTwo.docs.push(data[i]);}}else{if((currentNum)%4===3){items.columnThree.docs.push(data[i]);}else{items.columnOne.docs.push(data[i]);}}}else if(_this.view.breakpoint.className===_this.view.breakPointOne.className){if((currentNum)%3===0){items.columnThree.docs.push(data[i]);}else if((currentNum)%3===1){items.columnOne.docs.push(data[i]);}else if((currentNum)%3===2){items.columnTwo.docs.push(data[i]);}}else{items.columnOne.docs.push(data[i]);}
_this.checkTotalRendered();}}
_this.view.renderItemsToColumns(items);_this.currentItemNum=currentNum;_this.setImageRatio();_this.addTransition();if(_this.pageNumber===0&&(_this.itemsRenderedCount===_this.rowsPerPage)){_this.checkContentHeight();}
$(window).resize(function(e){_this.trimToFit();});_this.trimToFit();},fadeOutResults:function(){if(this.tabsFilter){if(this.moduleElement.find('.s_layouts_snapResults .s_animation_animate').hasClass('s_animation_animate_fadein')){this.moduleElement.find('.s_layouts_snapResults .s_animation_animate').removeClass('s_animation_animate_fadein');}}else{if(this.moduleElement.find('.s_animation_animate').hasClass('s_animation_animate_fadein')){this.moduleElement.find('.s_animation_animate').removeClass('s_animation_animate_fadein');}}},resultsClearOut:function(filteredSearch){var _this=this;_this.view.emptyResultColumns();if(_this.view.snapHeaderOuter){_this.view.snapHeaderOuter.empty();}
if(_this.view.snapMessageWrapper){_this.view.snapMessageWrapper.empty();}
_this.itemsRenderedCount=0;_this.currentItemNum=0;_this.pageNumber=0;_this.totalResults=null;if(!filteredSearch){_this.filterTerm=null;_this.view.emptyResultColumns();_this.tabsFilter=false;}
_this.playLoadingAnim('loadingFirstPage');},checkTotalRendered:function(){++this.itemsRenderedCount;},checkScrolledPosition:function(){var _this=this,scrolled=_this.view.snapWrapper.scrollTop(),snapWrapperHeight=Math.floor(_this.view.snapWrapper[0].getBoundingClientRect().height),snapContainerHeight=Math.floor(_this.view.snapContainer[0].getBoundingClientRect().height);return scrolled+snapWrapperHeight>=snapContainerHeight;},checkContentHeight:function(){var _this=this,snapWrapperHeight=_this.view.snapWrapper.innerHeight(),snapContainerHeight=_this.view.snapContainer.innerHeight();if(snapWrapperHeight>=snapContainerHeight){_this.getNextResults();}},generateTabInfo:function(data){var _this=this,tabsList=_this.feedResponse.result.data.tabs,bucketNames=data.bucketName_s,tabs=[],buckets={};_this.view.emptyTabs();if(tabsList&&tabsList.length>0){tabsList.forEach(function(value){if(value.bucket==='All'){tabs.push({label:value.label,bucket:value.bucket,active:"active"});}else{if(bucketNames.indexOf(value.bucket)>-1){tabs.push({label:value.label,bucket:value.bucket});}}});}
buckets.tabs=tabs;_this.view.generateTabItems(buckets);_this.addTabClickEvent();},addTabClickEvent:function(){var _this=this,$tab,timer;_this.tabsFilter=false;_this.moduleElement.find('.s_layouts_snapTab').on('click',function(){$tab=$(this);_this.fireTrackingTabs(_this,$tab.attr('data-filter'));_this.requestNumber++;window.clearTimeout(timer);timer=window.setTimeout(function(){_this.fadeOutResults();},20);_this.moduleElement.find('.s_layouts_snapResults .s_animation_animate').on('transitionend webkitTransitionEnd oTransitionEnd',function(event){_this.tabsFilter=true;if(!$(this).hasClass('s_animation_animate_fadein')){_this.moduleElement.find('.s_layouts_snapTabs').find('.active').removeClass('active');$tab.addClass('active');_this.setFilterTerm($tab.attr('data-filter'));_this.delayProcessSearch(_this.tabsFilter);$(this).off(event);}});});},setFilterTerm:function(value){this.filterTerm=value;},addTransition:function(){var _this=this,delayTransition;clearTimeout(delayTransition);delayTransition=setTimeout(function(){if(_this.tabsFilter){_this.moduleElement.find('.s_layouts_snapTab.s_animation_animate').removeClass('s_animation_animate');_this.moduleElement.find('.s_layouts_snapResults .s_animation_animate').addClass('s_animation_animate_fadein');}else{_this.moduleElement.find('.s_animation_animate').addClass('s_animation_animate_fadein');_this.moduleElement.find('.s_animation_animate').on('transitionend webkitTransitionEnd oTransitionEnd',function(event){_this.moduleElement.find('.s_layouts_snapTab.s_animation_animate').removeClass('s_animation_animate s_animation_animate_fadein');$(this).off(event);});}
_this.triggerImageBroker();},1);},triggerImageBroker:function(){window.Triforce.getMediator().trigger('triforce:pageintouch');}}};$Crabapple.TriforceView_ent_m171={'parentView':'$Crabapple.TriforceMustacheView','extention':{templateName:'Modules/ENT_M171/V8_0_0/Controller/default',itemsTemplateName:'Modules/ENT_M171/V8_0_0/Controller/items',filtersTemplateName:'Modules/ENT_M171/V8_0_0/Controller/filters',columnsTemplateName:'Modules/ENT_M171/V8_0_0/Controller/columns',messageTemplateName:'Modules/ENT_M171/V8_0_0/Controller/message',headerTemplateName:'Modules/ENT_M171/V8_0_0/Controller/header',coreElement:null,defaultQuality:0.75,viewPortWidth:$(window).width(),breakPointOne:{'width':603,'className':'s_layouts_three_column'},breakPointTwo:{'width':768,'className':'s_layouts_four_column'},breakPointMobile:{'width':602,'className':'s_layouts_one_column'},breakpoint:null,placeholderActiveIE:true,data:null,snapWrapper:null,snapContainer:null,snapInput:null,snapMessageWrapper:null,snapTabs:null,snapResults:null,snapResultsWrapper:null,columns:{columnOne:null,columnTwo:null,columnThree:null,columnFour:null},generateModuleComponents:function(){this.generateTabsNav();this.placeholderFix();},setData:function(data){this.data=data;},setViewElements:function(){var _this=this;_this.snapWrapper=_this.moduleElement.find('.s_layouts_snapWrapper');_this.snapSearch=_this.moduleElement.find('.s_layouts_snapSearchWrapper');_this.snapContainer=_this.snapWrapper.find('.s_layouts_snap');_this.snapInput=_this.snapContainer.find('.s_layouts_snapInput');_this.snapHeader=_this.moduleElement.find('.s_layouts_snapHeader');_this.snapHeaderOuter=_this.moduleElement.find('.s_layouts_snapHeaderOuter');_this.snapTabs=_this.snapContainer.find('.s_layouts_snapTabs');_this.snapMessageWrapper=_this.snapContainer.find('.s_layouts_snapMessageWrapper');_this.snapResultsWrapper=_this.snapContainer.find('.s_layouts_snapResultsWrapper');_this.columns={columnOne:_this.snapResultsWrapper.find('.s_layouts_snapColumn.one'),columnTwo:_this.snapResultsWrapper.find('.s_layouts_snapColumn.two'),columnThree:_this.snapResultsWrapper.find('.s_layouts_snapColumn.three'),columnFour:_this.snapResultsWrapper.find('.s_layouts_snapColumn.four')};_this.snapInput.attr('placeholder',this.data.placeHolderText);},initMobileSearch:function(){this.snapWrapper.addClass('is_mobile_device');},setBreakpoint:function(){if(this.viewPortWidth<=this.breakPointOne.width){this.breakpoint=this.breakPointMobile;}else if(this.viewPortWidth<=this.breakPointTwo.width&&this.viewPortWidth>this.breakPointOne.width){this.breakpoint=this.breakPointOne;}else if(this.viewPortWidth>this.breakPointTwo.width){this.breakpoint=this.breakPointTwo;}
this.snapWrapper.addClass(this.breakpoint.className);},placeholderFix:function(){var _this=this,resetPlaceholder=function(){_this.snapInput.val(_this.defaultPlaceholderText);if(_this.snapInput[0].setSelectionRange){_this.snapInput[0].setSelectionRange(0,0);}else if(_this.snapInput[0].createTextRange){var range=_this.snapInput[0].createTextRange();range.collapse(true);range.moveEnd('character',0);range.moveStart('character',0);range.select();}
_this.snapInput.addClass('snap-input-placeholder');_this.placeholderActiveIE=true;},checkInputValue=function(){if(_this.snapInput.val()===_this.defaultPlaceholderText||_this.snapInput.val()===''){resetPlaceholder();}},clearInputPlaceholder=function(e){if(_this.snapInput.val()===_this.defaultPlaceholderText&&e.keyCode!==37&&e.keyCode!==38&&e.keyCode!==39&&e.keyCode!==40){e.preventDefault();_this.snapInput.val('');_this.snapInput.val(String.fromCharCode(e.keyCode));_this.snapInput.removeClass('snap-input-placeholder');_this.placeholderActiveIE=false;}else if((_this.snapInput.val()===_this.defaultPlaceholderText||_this.snapInput.val()==='')&&(e.keyCode===37||e.keyCode===38||e.keyCode===39||e.keyCode===40)){e.preventDefault();resetPlaceholder();}else{_this.snapInput.removeClass('snap-input-placeholder');_this.placeholderActiveIE=false;}};if((navigator.userAgent.indexOf("MSIE")>-1||(!(window.ActiveXObject)&&"ActiveXObject"in window))&&/x64|x32/ig.test(window.navigator.userAgent)===false){this.defaultPlaceholderText=this.snapInput.attr('placeholder');this.snapInput.addClass('snap-input-placeholder');this.snapInput.on('blur focus click',checkInputValue);this.snapInput.on('keypress',clearInputPlaceholder);}},generateMessage:function(data){var _this=this;_this.renderTemplateTo(_this.messageTemplateName,_this.snapMessageWrapper,{message:data});},removeMessage:function(){this.snapMessageWrapper.empty();},renderHeader:function(data){var _this=this;_this.snapHeaderOuter.empty();_this.renderTemplateTo(_this.headerTemplateName,_this.snapHeaderOuter,data);},renderItemsToColumns:function(items){var _this=this;for(var column in items){if(items.hasOwnProperty(column)){this.renderTemplateTo(_this.itemsTemplateName,_this.columns[column],items[column]);}}},emptyTabs:function(){this.snapTabs.empty();},emptyResultColumns:function(){var columns=this.columns;for(var column in columns){if(columns.hasOwnProperty(column)){columns[column].empty();}}},generateTabItems:function(data){this.renderTemplateTo(this.filtersTemplateName,this.snapTabs,data);}}};(function(name){this.$Crabapple=this.$Crabapple||{};this.$Crabapple.TriforceTemplates=this.$Crabapple.TriforceTemplates||{};this.$Crabapple.TriforceTemplates[name]=this.$Crabapple.TriforceTemplates[name]||new Hogan.Template({code:function(c,p,i){var t=this;t.b(i=i||"");if(t.s(t.f("data",c,p,1),c,p,0,9,1101,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<div class=\"s_layouts_snapWrapper\" tabindex=\"-1\"><!--s_layouts_four_column --><div class=\"s_layouts_snap\"><div class=\"s_layouts_snapInputWrapper");if(t.s(t.f("showId",c,p,1),c,p,0,164,180,"{{ }}")){t.rs(c,p,function(c,p,t){t.b(" series_specific");});c.pop();}t.b("\"><input type=\"text\" class=\"s_layouts_snapInput\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" placeholder=\"");t.b(t.v(t.f("placeHolderText",c,p,0)));t.b("\">");if(t.s(t.f("showId",c,p,1),c,p,0,362,521,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<div class=\"s_layouts_snapSearchWrapper\"><span class=\"s_layouts_this_show highlight\">THIS SHOW</span><span class=\"s_layouts_whole_site\">WHOLE SITE</span></div>");});c.pop();}t.b("<input type=\"submit\" class=\"s_layouts_snapSubmit\"><div class=\"s_layouts_snapClose\"><span class=\"screen-reader-text\">close</span></div></div><div class=\"s_layouts_snapHeaderWrapper\"><div class=\"s_layouts_snapTabs\">");t.b(t.rp("<Modules/ENT_M171/V8_0_0/Controller/filters0",c,p,""));t.b("</div><div class=\"s_layouts_snapMessageWrapper\">");t.b(t.rp("<Modules/ENT_M171/V8_0_0/Controller/message1",c,p,""));t.b("</div><div class=\"s_layouts_snapHeaderOuter\">");t.b(t.rp("<Modules/ENT_M171/V8_0_0/Controller/header2",c,p,""));t.b("</div></div><div class=\"s_layouts_snapResultsWrapper\">");t.b(t.rp("<Modules/ENT_M171/V8_0_0/Controller/columns3",c,p,""));t.b("</div></div></div>");});c.pop();}return t.fl();},partials:{"<Modules/ENT_M171/V8_0_0/Controller/filters0":{name:"Modules/ENT_M171/V8_0_0/Controller/filters",partials:{},subs:{}},"<Modules/ENT_M171/V8_0_0/Controller/message1":{name:"Modules/ENT_M171/V8_0_0/Controller/message",partials:{},subs:{}},"<Modules/ENT_M171/V8_0_0/Controller/header2":{name:"Modules/ENT_M171/V8_0_0/Controller/header",partials:{},subs:{}},"<Modules/ENT_M171/V8_0_0/Controller/columns3":{name:"Modules/ENT_M171/V8_0_0/Controller/columns",partials:{},subs:{}}},subs:{}});}).call(this,"Modules/ENT_M171/V8_0_0/Controller/default");(function(name){this.$Crabapple=this.$Crabapple||{};this.$Crabapple.TriforceTemplates=this.$Crabapple.TriforceTemplates||{};this.$Crabapple.TriforceTemplates[name]=this.$Crabapple.TriforceTemplates[name]||new Hogan.Template({code:function(c,p,i){var t=this;t.b(i=i||"");if(t.s(t.f("tabs",c,p,1),c,p,0,9,111,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<span class=\"s_layouts_snapTab");if(t.s(t.f("active",c,p,1),c,p,0,50,57,"{{ }}")){t.rs(c,p,function(c,p,t){t.b(" active");});c.pop();}t.b("\" data-filter=\"");t.b(t.v(t.f("bucket",c,p,0)));t.b("\">");t.b(t.v(t.f("label",c,p,0)));t.b("</span>");});c.pop();}if(t.s(t.f("bucketName_s",c,p,1),c,p,0,137,239,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<span class=\"s_layouts_snapTab");if(t.s(t.f("active",c,p,1),c,p,0,178,185,"{{ }}")){t.rs(c,p,function(c,p,t){t.b(" active");});c.pop();}t.b("\" data-filter=\"");t.b(t.v(t.f("bucket",c,p,0)));t.b("\">");t.b(t.v(t.f("label",c,p,0)));t.b("</span>");});c.pop();}return t.fl();},partials:{},subs:{}});}).call(this,"Modules/ENT_M171/V8_0_0/Controller/filters");(function(name){this.$Crabapple=this.$Crabapple||{};this.$Crabapple.TriforceTemplates=this.$Crabapple.TriforceTemplates||{};this.$Crabapple.TriforceTemplates[name]=this.$Crabapple.TriforceTemplates[name]||new Hogan.Template({code:function(c,p,i){var t=this;t.b(i=i||"");t.b("<div class=\"s_layouts_snapMessage\">");t.b(t.v(t.f("message",c,p,0)));t.b("</div>");return t.fl();},partials:{},subs:{}});}).call(this,"Modules/ENT_M171/V8_0_0/Controller/message");(function(name){this.$Crabapple=this.$Crabapple||{};this.$Crabapple.TriforceTemplates=this.$Crabapple.TriforceTemplates||{};this.$Crabapple.TriforceTemplates[name]=this.$Crabapple.TriforceTemplates[name]||new Hogan.Template({code:function(c,p,i){var t=this;t.b(i=i||"");t.b("<div class=\"s_layouts_snapHeader s_animation_animate s_trending_snapHeader s_animation_animate_fadein\">");t.b(t.v(t.f("header",c,p,0)));t.b("</div>");return t.fl();},partials:{},subs:{}});}).call(this,"Modules/ENT_M171/V8_0_0/Controller/header");(function(name){this.$Crabapple=this.$Crabapple||{};this.$Crabapple.TriforceTemplates=this.$Crabapple.TriforceTemplates||{};this.$Crabapple.TriforceTemplates[name]=this.$Crabapple.TriforceTemplates[name]||new Hogan.Template({code:function(c,p,i){var t=this;t.b(i=i||"");t.b("<ul class=\"s_layouts_snapResults\"><div class=\"s_layouts_snapColumn one\">");if(t.s(t.f("columnOne",c,p,1),c,p,0,86,132,"{{ }}")){t.rs(c,p,function(c,p,t){t.b(t.rp("<Modules/ENT_M171/V8_0_0/Controller/items0",c,p,""));});c.pop();}t.b("</div><div class=\"s_layouts_snapColumn two\">");if(t.s(t.f("columnTwo",c,p,1),c,p,0,204,250,"{{ }}")){t.rs(c,p,function(c,p,t){t.b(t.rp("<Modules/ENT_M171/V8_0_0/Controller/items1",c,p,""));});c.pop();}t.b("</div><div class=\"s_layouts_snapColumn three\">");if(t.s(t.f("columnThree",c,p,1),c,p,0,326,372,"{{ }}")){t.rs(c,p,function(c,p,t){t.b(t.rp("<Modules/ENT_M171/V8_0_0/Controller/items2",c,p,""));});c.pop();}t.b("</div><div class=\"s_layouts_snapColumn four\">");if(t.s(t.f("columnFour",c,p,1),c,p,0,448,494,"{{ }}")){t.rs(c,p,function(c,p,t){t.b(t.rp("<Modules/ENT_M171/V8_0_0/Controller/items3",c,p,""));});c.pop();}t.b("</div></ul>");return t.fl();},partials:{"<Modules/ENT_M171/V8_0_0/Controller/items0":{name:"Modules/ENT_M171/V8_0_0/Controller/items",partials:{},subs:{}},"<Modules/ENT_M171/V8_0_0/Controller/items1":{name:"Modules/ENT_M171/V8_0_0/Controller/items",partials:{},subs:{}},"<Modules/ENT_M171/V8_0_0/Controller/items2":{name:"Modules/ENT_M171/V8_0_0/Controller/items",partials:{},subs:{}},"<Modules/ENT_M171/V8_0_0/Controller/items3":{name:"Modules/ENT_M171/V8_0_0/Controller/items",partials:{},subs:{}}},subs:{}});}).call(this,"Modules/ENT_M171/V8_0_0/Controller/columns");(function(name){this.$Crabapple=this.$Crabapple||{};this.$Crabapple.TriforceTemplates=this.$Crabapple.TriforceTemplates||{};this.$Crabapple.TriforceTemplates[name]=this.$Crabapple.TriforceTemplates[name]||new Hogan.Template({code:function(c,p,i){var t=this;t.b(i=i||"");if(t.s(t.f("docs",c,p,1),c,p,0,9,1173,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<a href=\"");t.b(t.v(t.f("url_s",c,p,0)));t.b("\" class=\"s_layouts_snapItem s_layouts_snapItemLink s_animation_animate s_animation_animate s_layouts_snapItem");t.b(t.v(t.f("bucketName_s",c,p,0)));t.b(" s_animation_animate_fadein\" data-content-type=\"");t.b(t.v(t.f("contentType_s",c,p,0)));t.b("\"><div class=\"tve_lock\">");if(t.s(t.f("isTveAuthRequiredForDesktop_b",c,p,1),c,p,0,275,313,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<span class=\"tve_lock_desktop\"></span>");});c.pop();}if(t.s(t.f("isTveAuthRequiredForMobile_b",c,p,1),c,p,0,380,417,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<span class=\"tve_lock_mobile\"></span>");});c.pop();}t.b("</div><div class=\"s_layouts_snapImageWrapper\">");t.b(t.rp("<common/image0",c,p,""));if(t.s(t.f("labelName_s",c,p,1),c,p,0,531,575,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<div class=\"s_layouts_snapBadge\">");t.b(t.v(t.d(".",c,p,0)));t.b("</div>");});c.pop();}if(t.s(t.f("duration_s",c,p,1),c,p,0,606,659,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<span class=\"s_layouts_snapItemDuration\">");t.b(t.v(t.d(".",c,p,0)));t.b("</span>");});c.pop();}t.b("</div><div class=\"s_layouts_snapItemDetails\"><div class=\"s_layouts_snapItemDetailsContainer\">");if(t.s(t.f("title_t",c,p,1),c,p,0,779,844,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<span class=\"s_layouts_snapItemTitle\"><span>");t.b(t.t(t.d(".",c,p,0)));t.b("</span></span>");});c.pop();}if(t.s(t.f("subTitle",c,p,1),c,p,0,869,924,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<span class=\"s_layouts_snapItemSubtitle\">");t.b(t.t(t.d(".",c,p,0)));t.b("</span>");});c.pop();}if(t.s(t.f("seasonNumber_s",c,p,1),c,p,0,956,1090,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("<span class=\"s_layouts_snapItemMetaTitle\">");t.b(t.v(t.f("seasonLabel",c,p,0)));t.b(" ");t.b(t.v(t.d(".",c,p,0)));if(t.s(t.f("episodeNumber_s",c,p,1),c,p,0,1039,1063,"{{ }}")){t.rs(c,p,function(c,p,t){t.b(", ");t.b(t.v(t.f("episodeLabel",c,p,0)));t.b(" ");t.b(t.v(t.d(".",c,p,0)));});c.pop();}t.b("</span>");});c.pop();}t.b("</div></div><div class=\"testing_order\">");t.b(t.v(t.f("renderCount",c,p,0)));t.b("</div></a>");});c.pop();}return t.fl();},partials:{"<common/image0":{name:"common/image",partials:{},subs:{}}},subs:{}});}).call(this,"Modules/ENT_M171/V8_0_0/Controller/items");